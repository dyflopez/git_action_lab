name: Crear estructura de proyecto

on:
  workflow_dispatch:
    inputs:
      structure:
        description: 'Estructura de carpetas (separadas por comas)'
        required: true
        default: 'api,api/controllers,api/services,frontend,backend,infra'
      repo:
        description: 'Nombre del repositorio donde se crear치 la estructura'
        required: true

jobs:
  create-structure:
    runs-on: ubuntu-latest
    steps:
      - name: Clonar el repositorio destino
        uses: actions/checkout@v4
        with:
          repository: ${{ github.repository_owner }}/${{ github.event.inputs.repo }}
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Crear la estructura de carpetas y archivos
        run: |
          IFS=',' read -r -a FOLDERS <<< "${{ github.event.inputs.structure }}"
          for folder in "${FOLDERS[@]}"; do
            mkdir -p "$folder"
            touch "$folder/.gitkeep"
          done
          
          # Crear un archivo dentro de 'infra'
          echo "Este es un archivo de configuraci칩n inicial" > infra/config.txt
          echo "# Documentaci칩n del proyecto" > README.md

      - name: Confirmar cambios y hacer push
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add .
          git commit -m "Estructura inicial creada autom치ticamente"
          git push
